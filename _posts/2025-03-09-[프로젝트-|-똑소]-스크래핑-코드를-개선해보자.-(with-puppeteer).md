---
layout: post
date: 2025-03-09
title: "[í”„ë¡œì íŠ¸ | ë˜‘ì†Œ] ìŠ¤í¬ë˜í•‘ ì½”ë“œë¥¼ ê°œì„ í•´ë³´ì. (with puppeteer)"
tags: [puppeteer, ]
categories: [í”„ë¡œì íŠ¸, ë˜‘ì†Œ, ]
mermaid: true
---


> ğŸ’¡ ë˜‘ì†Œ ë©”ì¸ ìŠ¤í¬ë˜í¼ ì„œë²„ë¥¼ ë³´ì¡°í•˜ëŠ” ìŠ¤í¬ë˜í¼ CLI í”„ë¡œê·¸ë¨ ê°œì„ ê¸°ì— ëŒ€í•œ ë‚´ìš©ì…ë‹ˆë‹¤. ì§€ì†ì ìœ¼ë¡œ ì§„í–‰ì¤‘ì´ì§€ë§Œ, ì´ë²ˆì— â€œì˜¤ëŠ˜ì€ ì¨ì•¼ì§€â€ í™œë™ì—ì„œ **â€œì´ì œ ì™€ì„œ ê³ ì³ë³´ëŠ” 2024ë…„ì˜ ë‚´ ì½”ë“œâ€** ì£¼ì œì— ì í•©í•˜ë‹¤ê³  ìƒê°í•´ ì‘ì„±í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.



### 1. ì½”ë“œ ê°œì„  ë°°ê²½


ê¸°ì¡´ CLI í”„ë¡œê·¸ë¨ì€ ë‹¨ìˆœí•˜ê²Œ HTTP ìš”ì²­ì„ í†µí•´ ì‘ë‹µëœ HTMLì„ íŒŒì‹±í•˜ëŠ” ì—­í• ë§Œ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤.


ê·¸ëŸ¬ë‹¤ ìš”êµ¬ì‚¬í•­ì— ì˜í•´ ë³´ì¡° í”„ë¡œê·¸ë¨ë„ ë¡œê·¸ì¸ì„ í†µí•œ ë™ì  ìŠ¤í¬ë˜í•‘ì´ í•„ìš”í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. (ì£¼ëœ ìš”êµ¬ì‚¬í•­ì€ ë¡œê·¸ì¸ëœ ê°€ê²© ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì…ë‹ˆë‹¤.) 


ê¸°ì¡´ ì½”ë“œì˜ ê²½ìš° ë‹¨ìˆœí•œ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆì—ˆìŠµë‹ˆë‹¤.



{% raw %}
```bash
$ tree -L 2 /src

./src
â”‚
â”œâ”€â”€ lib                    # ê³µìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ì„± ê³µí†µ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ cli
â”‚   â”œâ”€â”€ client
â”‚   â”œâ”€â”€ db                 # dbê´€ë ¨ ëª¨ë“ˆë¡œ drizzleë¥¼ ì§ì ‘ ì‚¬ìš©
â”‚   â”œâ”€â”€ html-client.ts     # http í†µì‹ ìš© ëª¨ë“ˆ
â”‚   â”œâ”€â”€ util
â”‚   â”œâ”€â”€ global-constant.ts
â”‚   â”œâ”€â”€ global-type.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ repository             # ormì„ ì‚¬ìš©í•˜ëŠ” ì˜ì†í™” ê³„ì¸µ
â”‚   â”œâ”€â”€ xxx.repository.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ service
â”‚   â”œâ”€â”€ a-vendor-scrap.service.ts   **# í˜¼ëˆê³¼ ì¹´ì˜¤ìŠ¤ì˜ ì„œë¹„ìŠ¤ ê³„ì¸µ**
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ scraper.cli.ts  # ìŠ¤í¬ë˜í¼ CLI
â””â”€â”€ index.ts
```
{% endraw %}



ì´ ì½”ë“œì— `puppeteer`ë¥¼ ì‚¬ìš©í•˜ëŠ” ìŠ¤í¬ë˜í¼ë¥¼ ë„£ì–´ì•¼ í–ˆìŠµë‹ˆë‹¤.


ë¨¼ì € `puppeteer`ê°€ ì–´ë–¤ ê²ƒì¸ì§€ ê°„ë‹¨í•˜ê²Œ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.



### 2. puppeteer ê¸°ë³¸ ì•„í‚¤í…ì²˜


> ğŸ’¡ puppeteerë¥¼ ì‚¬ìš©í•˜ëŠ” ì£¼ëœ ì´ìœ ëŠ” ì„±ëŠ¥ê³¼ `CDPSession`ë¥¼ ì‚¬ìš©í•´ í¬ë¡¬ì˜ ê°œë°œì ë„êµ¬ë¥¼ ì €ìˆ˜ì¤€ ë ˆë²¨ë¡œ ì»¨íŠ¸ë¡¤ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë” êµ¬ì²´ì ì¸ ì •ë³´ëŠ” í¬ìŠ¤íŒ… ì¤€ë¹„ì¤‘ì— ìˆìŠµë‹ˆë‹¤.


PuppeteerëŠ” Chrome DevTools Protocolì„ ì‚¬ìš©í•˜ì—¬ Chrome/Chromiumì„ ì œì–´í•˜ëŠ” Node.js ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.

- Node.js ë©”ì¸ í”„ë¡œì„¸ìŠ¤
- Chrome ë¸Œë¼ìš°ì € í”„ë¡œì„¸ìŠ¤


#### 2.1. puppeteer ì£¼ìš” ì»´í¬ë„ŒíŠ¸



{% raw %}
```text
Browser (ë¸Œë¼ìš°ì € ì¸ìŠ¤í„´ìŠ¤)
â”œâ”€â”€ CDPSession (Chrome DevTools Protocol ì„¸ì…˜)
â””â”€â”€ BrowserContext (ë¸Œë¼ìš°ì € ì»¨í…ìŠ¤íŠ¸)
    â””â”€â”€ Page (í˜ì´ì§€)
        â”œâ”€â”€ Frame (í”„ë ˆì„)
        â”œâ”€â”€ ExecutionContext (ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸)
        â””â”€â”€ Worker (ì›¹ ì›Œì»¤)
```
{% endraw %}



**Browser**

- Puppeteerì˜ ë©”ì¸ ì§„ì…ì 
- ë¸Œë¼ìš°ì € ìˆ˜ì¤€ì˜ ì‘ì—… ê´€ë¦¬
- ì—¬ëŸ¬ ê°œì˜ ë¸Œë¼ìš°ì € ì»¨í…ìŠ¤íŠ¸ì™€ í˜ì´ì§€ë¥¼ ê´€ë¦¬
- DevTools í”„ë¡œí† ì½œì„ í†µí•´ Chromeê³¼ í†µì‹ 

**CDPSession**

- Chrome DevTools Protocolì„ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ì €ìˆ˜ì¤€ ì¸í„°í˜ì´ìŠ¤
- ë¸Œë¼ìš°ì €ì˜ ê³ ê¸‰ ê¸°ëŠ¥ì— ì ‘ê·¼ ê°€ëŠ¥
- ë„¤íŠ¸ì›Œí¬ ì¡°ì‘, í”„ë¡œíŒŒì¼ë§, ë©”ëª¨ë¦¬ ê´€ë¦¬ ë“± ìˆ˜í–‰
- **Browser, Page ê°ì²´ë¥¼ í†µí•´ ìƒì„± ë° ê´€ë¦¬**

**Browser Context**

- ë¸Œë¼ìš°ì € ë‚´ì˜ ê²©ë¦¬ëœ í™˜ê²½
- ê°ê° ë…ë¦½ì ì¸ ì¿ í‚¤, ìºì‹œ, ì €ì¥ì†Œ ìƒíƒœ ë³´ìœ 
- incognito ì°½ê³¼ ìœ ì‚¬í•œ ê°œë…

**Page**

- ë¸Œë¼ìš°ì €ì˜ ê° íƒ­ì´ë‚˜ ì°½ì„ ëŒ€í‘œ
- DOM ì¡°ì‘, ì´ë²¤íŠ¸ ì²˜ë¦¬, ìŠ¤í¬ë¦°ìƒ· ë“± í˜ì´ì§€ ìˆ˜ì¤€ì˜ ì‘ì—… ìˆ˜í–‰
- ê° í˜ì´ì§€ëŠ” ë…ë¦½ì ì¸ JavaScript ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ë³´ìœ 

ì¦‰, `puppeteer`ë¥¼ ì‚¬ìš©í•˜ëŠ” ìŠ¤í¬ë˜í¼ë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. `puppeteer`ëŠ” ê½¤ë‚˜ ìì£¼ ë³€ê²½ë˜ê³  ë³µì¡í•˜ë‹¤ë©´ ë³µì¡í•œ í¸ì— ì†í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ í˜„ì¬ ì„œë¹„ìŠ¤ì— í•„ìš”í•œ ê¸°ëŠ¥ì€ í¬ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¨¼ì € í•„ìš”í•œ ê¸°ëŠ¥ì„ ì •ì˜í•©ë‹ˆë‹¤.


í•„ìš”í•œ ê¸°ëŠ¥ ì •ì˜

1. ë¸Œë¼ìš°ì € ì—”ì§„ ì‚¬ìš© ì˜µì…˜ì„ ì£¼ì…
2. ë¸Œë¼ìš°ì € ì—”ì§„ ì´ˆê¸°í™”
3. ë¸Œë¼ìš°ì € ì•ˆì „í•˜ê²Œ ì¢…ë£Œ
4. í˜ì´ì§€ ì´ë™
5. í˜„ì¬ í˜ì´ì§€ HTML ê°€ì ¸ì˜¤ê¸°
6. ê°œë°œì ëª¨ë“œ í•¸ë“¤ëŸ¬ - ì¿ í‚¤, ì„¸ì…˜ ë“± í•¸ë“¤ë§
7. ê°œë°œì ëª¨ë“œì—ì„œ HTML ìš”ì²­

ê²°ê³¼ì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ì´ ë‚˜ì™”ìŠµë‹ˆë‹¤.



```mermaid
classDiagram
    class PuppeteerScraperConfig {
        +readonly isHeadlessMode: boolean
        +readonly proxy: ProxyConfig
        +validate()
    }

    class PuppeteerScraper {
        +static create(config: PuppeteerScraperConfig): PuppeteerScraper
        +static throwException(message: string): never
        +init(): Promise<this>
        +close()
        +isInitialized(): boolean
        +getCurrentUrl(): string
        +getMetaOgUrl(): string
        +getHtml(): string
        +requestHtmlInBrowser(url: string): string
        +clearCookie(cookieName: string): Promise<boolean>
    }
```




### 2. êµ¬í˜„ëœ PuppeteerScraperë¥¼ ì ìš©í•œ ê°œì„ ëœ ì½”ë“œ


> ğŸ’¡ interfaceë¥¼ í†µí•œ ì¶”ìƒí™”ëŠ” ì„¤ëª…ì— ë³µì¡ì„±ì„ ë‚®ì¶”ê¸° ìœ„í•´ ìƒëµí–ˆìŠµë‹ˆë‹¤.



#### 2.1. ì†ŒìŠ¤ì½”ë“œ í´ë” êµ¬ì¡° ê°„ëµ ì„¤ëª…



{% raw %}
```bash
$ tree -L 2 /src

./src
â”œâ”€â”€ **a_vendor**                # ìŠ¤í¬ë˜í•‘ ëŒ€ìƒ ë°´ë”ë³„ë¡œ ìƒì„±í•˜ëŠ” core ëª¨ë“ˆ
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ parser
â”‚   â”œâ”€â”€ scraper            # lib/puppeteerë¥¼ ìƒì† ìŠ¤í¬ë˜í¼
â”‚   â”œâ”€â”€ transformer
â”‚   â””â”€â”€ util
â”‚
â”œâ”€â”€ lib                    # ê³µìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ì„± ê³µí†µ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ cli
â”‚   â”œâ”€â”€ client
â”‚   â”œâ”€â”€ db                 # dbê´€ë ¨ ëª¨ë“ˆë¡œ drizzleë¥¼ ì§ì ‘ ì‚¬ìš©
â”‚   â”œâ”€â”€ **puppeteer          #** PuppeteerScraper, PuppeteerScraperConfig
â”‚   â”œâ”€â”€ util
â”‚   â”œâ”€â”€ global-constant.ts
â”‚   â”œâ”€â”€ global-type.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ repository             # ormì„ ì‚¬ìš©í•˜ëŠ” ì˜ì†í™” ê³„ì¸µ
â”‚   â”œâ”€â”€ xxx.repository.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ service
â”‚   â”œâ”€â”€ a-vendor-scrap.service.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ scraper.cli.ts  # ìŠ¤í¬ë˜í¼ CLI
â””â”€â”€ index.ts
```
{% endraw %}



ì†ŒìŠ¤ì½”ë“œì˜ í•µì‹¬ ì „ëµì€ ë‹¨ë°©í–¥ ì˜ì¡´ì…ë‹ˆë‹¤.

- `a_vendor` ëª¨ë“ˆì€ â†’ `lib` ëª¨ë“ˆì„ ì˜ì¡´í•œë‹¤.
- `lib` ëª¨ë“ˆì€ ì™¸ë¶€ì— ì˜ì¡´ì„±ì„ ê°€ì§€ì§€ ì•Šìœ¼ë©°, ë™ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ì´ ê°€ëŠ¥ í•´ì•¼í•œë‹¤.(ì™¸ë¶€ importê°€ ì—†ë‹¤)
- íŠ¹íˆ `lib/`**`puppeteer`**ëŠ” ì´í›„ ë…ë¦½ëœ npm ë¼ì´ë¸ŒëŸ¬ë¦¬í™”ë¥¼ í†µí•´ í”„ë¡œì íŠ¸ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ í•  ê³„íšì— ìˆìŠµë‹ˆë‹¤.


#### 2.2. CLI ì˜ì¡´ì„±


![0](/assets/img/2025-03-09-í”„ë¡œì íŠ¸--ë˜‘ì†Œ-ìŠ¤í¬ë˜í•‘-ì½”ë“œë¥¼-ê°œì„ í•´ë³´ì.-with-puppeteer.md/0.png)


CLIëŠ” Serviceë¥¼ ì§ì ‘ ì˜ì¡´í•©ë‹ˆë‹¤. 


ë˜í•œ REST APIë¡œ ë³€ê²½ë  ê²ƒì„ ì—¼ë‘í•´ì„œ ìµìˆ™í•œ ë ˆì´ì–´ë“œ ì•„í‚¤í…ì²˜ë¡œ ì„¤ê³„ë¥¼ í–ˆìŠµë‹ˆë‹¤.



#### 2.3. Service ì˜ì¡´ì„±


![1](/assets/img/2025-03-09-í”„ë¡œì íŠ¸--ë˜‘ì†Œ-ìŠ¤í¬ë˜í•‘-ì½”ë“œë¥¼-ê°œì„ í•´ë³´ì.-with-puppeteer.md/1.png)

- `Scraper`ì˜ ê²½ìš° ì•„ì§ ì—¬ëŸ¬ ê³ ë¯¼ ìˆì§€ë§Œ í˜„ì¬ëŠ” 1ê°œì˜ ë¸Œë¼ìš°ì € ì—”ì§„ì„ ì‚¬ìš©í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì„¤ê³„ í–ˆìŠµë‹ˆë‹¤.
- ë•Œë¬¸ì— `Scraper`ëŠ” ì„œë¹„ìŠ¤ì—ì„œ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì í•©í•œ í˜•íƒœì¸ ì´ˆê¸°í™”ì™€ ë¡œê·¸ì¸ëœ í˜ì´ì§€ ëœë”ë§ ìƒíƒœë¡œ ì£¼ì…ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.


#### 2.4. `scraper.cli.ts` í”Œë¡œìš° ì°¨íŠ¸ - ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€



```mermaid
flowchart TD
    A[í”„ë¡œê·¸ë¨ ì‹œì‘] --> B[í™˜ê²½ ì²´í¬ & DB ì—°ê²°]
    B --> C[Scraper ì´ˆê¸°í™” & ë¡œê·¸ì¸ ìˆ˜í–‰]
    C --> D[Transformer ìƒì„±]
    D --> E[Service ìƒì„±]
    E --> F{isë°˜ë³µ?}
    F -->|Yes| G[ìŠ¤í¬ë©í•  URL ëª©ë¡ ì¡°íšŒ]
    G --> H[ìƒí’ˆ ëª©ë¡ í˜ì´ì§€ ìŠ¤í¬ë˜í•‘ ì‹¤í–‰]
    H --> I[ëŒ€ê¸° sleep - ex. 10ë¶„]
    I --> F
    F -->|No| K[í”„ë¡œê·¸ë¨ ì¢…ë£Œ]

    style F fill:#ffb6c1
```



**ì‚¬ìš© ì˜ˆì‹œ**



{% raw %}
```typescript
 await ProgramRunner.create()
    .printEnv()
    .checkingEnv()
    .approval(async () => {
      await runDb(async (db) => {
        console.log('scraping start - ', new Date().toISOString());

        // 1. ìŠ¤í¬ë˜í¼ë¥¼ ì´ˆê¸°í™” í•˜ê³  ë¡œê·¸ì¸ ìˆ˜í–‰
        const a_vendorScraper = await A_VendorScraper.createAndLoginProcess(
          new A_VendorScraperConfig(),
        );
        // 2. html ë³€í™˜ê¸° ìƒì„±
        const transformer = new A_VendorTransformer(
          new A_VendorHtmlParserProvider(),
        );
        // 3. ì„œë¹„ìŠ¤ ìƒì„±
        const service = new A_VendorScrapService(
          a_vendorScraper,
          transformer,
          db,
        );

        while (remainingCount > 0) {
          // 1. ìŠ¤í¬ë˜í•‘ ëŒ€ìƒ URL ì¡°íšŒ
          const targetUrls =
            await service.getScrapProductListPageUrls();
          // 2. ìŠ¤í¬ë˜í•‘ ì‹¤í–‰
          await service.runScrapProductListPage(targetUrls);
          await ScraperUtil.sleep(INTERVAL);
        }
      });
    });
```
{% endraw %}




#### 2.5. `PuppeteerScraper` í´ë˜ìŠ¤ ë‹¤ì´ì–´ ê·¸ë¨


> ğŸ“Œ ìƒì† êµ¬ì¡°ë¥¼ ë§Œë“¤ê²Œ ëœ ì£¼ëœ ì´ìœ ëŠ” `Puppeteer`ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì½”ë“œì™€ ë²¤ë”ë³„ ì›¹ í˜ì´ì§€ë¥¼ ì»¨íŠ¸ë¡¤ í•˜ëŠ”ë° í•„ìš”í•œ ì½”ë“œê°€ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì— í˜¼ì¬ë˜ì–´ ë³µì¡ì„±ì´ ë†’ì•˜ê³ , ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ ìƒì†êµ¬ì¡°ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.



```mermaid
classDiagram
    class PuppeteerScraperConfig {
        +readonly isHeadlessMode: boolean
        +readonly proxy: ProxyConfig
        +validate()
    }

    class A_VendorScraperConfig {
        +readonly loginId: string
        +readonly loginPw: string
        +validate()
    }

    class PuppeteerScraper {
        +static create(config: PuppeteerScraperConfig): PuppeteerScraper
        +static throwException(message: string): never
        +init(): Promise<this>
        +close()
        +isInitialized(): boolean
        +getCurrentUrl(): string
        +getMetaOgUrl(): string
        +getHtml(): string
        +requestHtmlInBrowser(url: string): string
        +clearCookie(cookieName: string): Promise<boolean>
    }

    class A_VendorScraper {
        +static async createAndLoginProcess(config: A_VendorScraperConfig): Promise<A_VendorScraper>
        +static override throwException(message: string): never
        +async requestHtmlInBrowser(url: string)
        +async goto(url: string, delay: number): Promise<boolean>
        +async tryLoginAndRedirect(redirectUrl: string | null, _retryCount: number): Promise<string>
    }

    PuppeteerScraperConfig <|-- A_VendorScraperConfig
    PuppeteerScraper <|-- A_VendorScraper
```


- `PuppeteerScraperConfig`
	- `PuppeteerScraper`ë¥¼ ìƒì„±í•˜ê³  ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì˜µì…˜ì˜ ê´€ë¦¬ë¥¼ ì±…ì„ì§„ë‹¤.
- `A_VendorScraperConfig`
	- `A_VendorScraper`ë¥¼ ìƒì„±í•˜ê³  ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì˜µì…˜ì˜ ê´€ë¦¬ë¥¼ ì±…ì„ì§„ë‹¤.
	- `PuppeteerScraper`ë¥¼ ìƒì†í•œë‹¤.
- `PuppeteerScraper`
	- `Puppeteer`ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ core ë©”ì„œë“œì™€ ì „ëµì„ ì±…ì„ì§„ë‹¤.
	- `Puppeteer`ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ìŠ¤í¬ë˜í¼ ê°ì²´
- `A_VendorScraper`
	- `PuppeteerScraper`ë¥¼ ìƒì†í•œë‹¤.
	- A ë²¤ë”ë¥¼ ìŠ¤í¬ë˜í•‘ í•˜ëŠ”ë° í•„ìš”í•œ core ë¡œì§ì„ ê´€ë¦¬í•˜ëŠ” ì±…ì„ì„ ê°€ì§„ë‹¤.
		- ex) A ë²¤ë” login í˜ì´ì§€ ì ‘ê·¼ ë¡œê·¸ì¸ ìˆ˜í–‰


#### 2.6. `xxxParserProvider` í´ë˜ìŠ¤


> ğŸ“Œ - íŠ¹ì • HTML í˜ì´ì§€ ë§ˆë‹¤ ê³„ì† ìƒì„±ë  ì˜ˆì •ì¸ parser í´ë˜ìŠ¤ë¥¼ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ê³  ê³µê¸‰í•˜ëŠ” ì±…ì„ì„ ê°€ì§„ë‹¤.

	- íŠ¹ì • HTML í˜ì´ì§€ ë§ˆë‹¤ ê³„ì† ìƒì„±ë  ì˜ˆì •ì¸ parser í´ë˜ìŠ¤ë¥¼ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ê³  ê³µê¸‰í•˜ëŠ” ì±…ì„ì„ ê°€ì§„ë‹¤.


{% raw %}
```typescript
/** A ë²¤ë” page html íŒŒì„œë¥¼ ê³µê¸‰í•˜ëŠ” ê°ì²´ */
export class A_VendorHtmlParserProvider {
  /**
   * ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ íŒŒì„œ
   * @param html
   * @returns
   */
  getProductListParser(html: string): A_VendorProductListHtmlParser {
    return A_VendorProductListHtmlParser.parse(html);
  }

  /**
   * ìƒì„¸ í˜ì´ì§€ íŒŒì„œ
   * @param html
   * @returns
   */
  getProductDetailParser(html: string): A_VendorProductDetailHtmlParser {
    return A_VendorProductDetailHtmlParser.parse(html);
  }

	// ... ìƒëµ
}
```
{% endraw %}



**ì‚¬ìš© ì˜ˆì‹œ -** **`A_VendorTransformer`**



{% raw %}
```typescript
export class A_VendorTransformer {
  constructor(private readonly parserProvider: A_VendorHtmlParserProvider) {}
  
  /**
   * ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ì—ì„œ ìŠ¤í¬ë˜í•‘ëœ ë°ì´í„°ë¥¼ DBë‚˜ ë¡œì§ì— ì‚¬ìš©í•˜ê¸° ì í•©í•œ í˜•íƒœë¡œ ê°€ê³µ
   */
  transformByProductListPage(html: string): A_VenderProductListPage[] {
    const parser = this.parserProvider.getProductListParser(html);
    // ... ìƒëµ
  }
  
  /**
   * ìƒì„¸ í˜ì´ì§€ì—ì„œ ìŠ¤í¬ë˜í•‘ëœ ë°ì´í„°ë¥¼ DBë‚˜ ë¡œì§ì— ì‚¬ìš©í•˜ê¸° ì í•©í•œ í˜•íƒœë¡œ ê°€ê³µ
   */
  transformByDetailPage(
    vendorId: number,
    html: string,
  ): A_VenderDetailPage {
    const vendorParser = this.parserProvider.getVendorDetailParser(html);
    // ... ìƒëµ
  } 
}
```
{% endraw %}


