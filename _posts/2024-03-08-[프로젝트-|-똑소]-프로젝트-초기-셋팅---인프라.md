---
layout: post
date: 2024-03-08
title: "[ν”„λ΅μ νΈ | λ‘μ†] ν”„λ΅μ νΈ μ΄κΈ° μ…‹ν… - μΈν”„λΌ"
tags: [AWS, github-action, ]
categories: [ν”„λ΅μ νΈ, λ‘μ†, ]
mermaid: true
---



### 1. μΈν”„λΌ μ„¤κ³„ λ° μ„Έν…


> π“ λ‘μ† μ„λΉ„μ¤λ” λ‘ κ°€μ§€ ν΄λΌμ°λ“ ν”λ ›νΌμ„ μ‚¬μ©ν•μ—¬ μ„λΉ„μ¤ν•κ³  μμµλ‹λ‹¤.

- μ΄μν™κ²½ **AWS(Amazon Web Services)**
- κ°λ°ν™κ²½ **NCP(Naver Cloud Platform)**

> π’΅ μ™ ν•λ‚μ ν΄λΌμ°λ“ μ„λΉ„μ¤κ°€ μ•„λ‹ λ‘ κ°€μ§€ ν΄λΌμ°λ“ μ„λΉ„μ¤λ¥Ό μ‚¬μ©ν•κ² λμ—μ„κΉμ”?


μ΄κΈ° ν΄λΌμ°λ“ μ„ μ • κ³Όμ • λ¶€ν„° μ‰½μ§€ μ•μ•μµλ‹λ‹¤.


ν”„λ΅μ νΈ λ¦¬λ”λ¶„μ΄ λΉ„μ©μ„ μµμ†ν™”μ— λ€ν• μμ§€λ¥Ό λ‚΄λ³΄μ€κ³ , μ΄ κ³Όμ •μ—μ„ KT ν΄λΌμ°λ“, NCP ν΄λΌμ°λ“ κ°™μ€ κµ­λ‚΄ ν΄λΌμ°λ“κ°€ ν›„λ³΄μ— λ“¤μ—μµλ‹λ‹¤. κµ­λ‚΄ ν΄λΌμ°λ“λ” λ§μ€ ν¬λλ”§μ„ μ κ³µν•λ” ν”„λ΅λ¨μ…μ΄ μμ—κΈ° λ•λ¬Έμ…λ‹λ‹¤.


ν•μ§€λ§ ν€λ‚΄μ— ν΄λΌμ°λ“ μ„λΉ„μ¤λ¥Ό μ§μ ‘μ μΌλ΅ λ‹¤λ£° μ μλ” κ°λ°μκ°€ μ—†μ—μµλ‹λ‹¤.
λ•λ¬Έμ— μ κ°€ λ©”μΈμΌλ΅ μΈν”„λΌ μ„Έν…μ„ λ‹΄λ‹Ήν•κ² λμ—κ³ , κ³ λ―Ό λμ— μµμ„ μ νƒ€ν‘μ„ ν–μµλ‹λ‹¤. 


μ—¬λ¬ μμ‚¬ κ²°μ • λμ— λ©”μΈ μ„λΉ„μ¤λ” AWSλ¥Ό μ‚¬μ©ν•κ³ , κ°λ° μ„λ²„λ‚ μ¶”κ°€ μ¤ν¬λν•‘ μ„λ²„λ” κ°€μ¥ ν¬λλ”§μ„ λ§μ΄ μ κ³µν•λ” NCPλ¥Ό μ‚¬μ©ν•κΈ°λ΅ κ²°μ •ν–μµλ‹λ‹¤.



#### 1.1. μ΄μ ν™κ²½ μΈν”„λΌ μ…‹ν…


λ‘μ† μ„λΉ„μ¤λ¥Ό μ΄μν•λ”λ° ν•„μ”ν• ν•„μ μμ›μ€ **AWS**λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. 


![0](/assets/img/2024-03-08-ν”„λ΅μ νΈ--λ‘μ†-ν”„λ΅μ νΈ-μ΄κΈ°-μ…‹ν…---μΈν”„λΌ.md/0.png)

1. DNSλ” `Route53`μ„ μ‚¬μ©ν•©λ‹λ‹¤.
	- μ΄κΈ°μ—λ” λ„λ©”μΈμ΄ `κ°€λΉ„μ•„`μ— μμ—μΌλ©°, μ΄ν›„ νΈμμ„±μ„ μ„ν•΄ `Route53`μΌλ΅ λ„λ©”μΈμ„ μ΄κ΄€ν–μµλ‹λ‹¤.
2. ν”„λ΅ νΈ μ„λ²„μ κ²½μ° κ΄€λ¦¬ νΈμμ„±μ„ μ„ν•΄ `Amplify`λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.
	- Web Server - Nextjs κΈ°λ°μ λ‘μ† μ›Ή νΈμ¤ν… μ„λ²„
3. API μ„λ²„λ” `EC2`λ¥Ό μ‚¬μ©ν•λ©°, Https μ‚¬μ©κ³Ό μ¤μΌ€μΌλ§ μ„ν•΄ ALBλ¥Ό μ‚¬μ©ν–μµλ‹λ‹¤.
	- API Server - λ‘μ† μ„λΉ„μ¤μ— ν•„μ”ν• λ¨λ“  API μ κ³µ
4. Scrap μ„λ²„λ” `EC2`λ¥Ό μ‚¬μ©, μ™Έλ¶€μ™€λ” API μ„λ²„λ¥Ό ν†µν•΄ ν†µμ‹ ν•κΈ° λ•λ¬Έμ— λ”°λ΅ ALBλ¥Ό λ¶™μ΄μ§€ μ•μ•μµλ‹λ‹¤.
	- Scrap Server: API μ„λ²„μ™€ ν†µμ‹ , URL κ²€μƒ‰κΈ°λ¥ μ κ³µ
	- Notification Server: μ΄λ©”μΌ μ•λ¦Ό, ν‘Έμ‹ μ•λ¦Ό
	- Batch Server
5. DBμ κ²½μ° μ—¬λ¬κ°€μ§€ μ΄μ μ— λ”°λΌ `Aurora Mysql`μ„ μ‚¬μ©ν•κΈ°λ΅ ν–μµλ‹λ‹¤.
	- μ£Όλ μ΄μ λ” μ•μ •μ„±κ³Ό κ΄€λ¦¬μ νΈμμ„± κ·Έλ¦¬κ³  **I/O λΉ„μ©μ΄ λ°μƒν•μ§€ μ•κΈ° λ•λ¬Έμ— μ‚¬μ©**ν–μµλ‹λ‹¤.


#### 1.2. κ°λ° ν™κ²½ μΈν”„λΌ μ…‹ν…


API μ„λ²„μ™€ μ§μ ‘μ μΈ μμ΅΄μ„±μ΄ μ—†λ” λ΅μ§κ³Ό κ°λ° μ„λ²„λ” **NCP**λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.


![1](/assets/img/2024-03-08-ν”„λ΅μ νΈ--λ‘μ†-ν”„λ΅μ νΈ-μ΄κΈ°-μ…‹ν…---μΈν”„λΌ.md/1.png)

1. Domainμ΄ Route53μ— μκΈ° λ•λ¬Έμ— Route53μ„ ν†µν•΄ νΈμ¤ν… λλ„λ΅ μ„Έν…ν–μµλ‹λ‹¤.
2. κ°λ° μ„λ²„μ κ²½μ° λ‹¨μΌ μ„λ²„λ¥Ό μ„λ€ν•κ³ , Mysqlμ„ μ§μ ‘ μ„¤μΉ μ‚¬μ©μ¤‘μ…λ‹λ‹¤.


### 2. λ°°ν¬ μ„¤κ³„μ™€ ν™κ²½ μ„Έν…


> π“ λ°°ν¬ μ‘μ—…μ€ νΉμ • ν΄λΌμ°λ“μ— μΆ…μ†λμ§€ μ•λ” Github Actionsμ„ μ κ·Ή μ‚¬μ©ν•κ³  μμµλ‹λ‹¤.


![2](/assets/img/2024-03-08-ν”„λ΅μ νΈ--λ‘μ†-ν”„λ΅μ νΈ-μ΄κΈ°-μ…‹ν…---μΈν”„λΌ.md/2.png)



#### λ°°ν¬ ν”λ΅μ° μ •λ¦¬


![3](/assets/img/2024-03-08-ν”„λ΅μ νΈ--λ‘μ†-ν”„λ΅μ νΈ-μ΄κΈ°-μ…‹ν…---μΈν”„λΌ.md/3.png)

- `Build`λ” ν„μ¬λ” λΉλ“ ν…μ¤νΈλ¥Ό μν–‰ν•κ³  μμΌλ©°, μ΄ν›„μ—λ” ν…μ¤νΈλ¥Ό μν–‰ν•  μμ •μ…λ‹λ‹¤.
- `Deploy`λ” μ—¬λ¬ ν΄λΌμ°λ“λ¥Ό μ‚¬μ©ν•κΈ° λ•λ¬Έμ— [**github self-hosted runner**](https://docs.github.com/ko/actions/hosting-your-own-runners/managing-self-hosted-runners/about-self-hosted-runners)**λ¥Ό μΈμ¤ν„΄μ¤μ— μ„¤μΉν•΄μ„ λ°°ν¬λ¥Ό μν–‰ν•©λ‹λ‹¤.**

π’΅Β dockerλ΅ ν™κ²½μ΄ λ³€κ²½λλ‹¤λ©΄?

- Buildμ—μ„λ” docker imageλ¥Ό λΉλ“ν•κ³  λ μ§€μ¤νΈλ¦¬μ— μ—…λ΅λ“ν•©λ‹λ‹¤.
- Deployμ—μ„λ” λ μ§€μ¤νΈλ¦¬μ—μ„ λΉλ“λ imageλ¥Ό λ‹¤μ΄λ΅λ“ν•κ³  μ‹¤ν–‰ν•©λ‹λ‹¤.


#### **github actions λ€μ‹λ³΄λ“ κ²°κ³Ό ν™•μΈ**


![4](/assets/img/2024-03-08-ν”„λ΅μ νΈ--λ‘μ†-ν”„λ΅μ νΈ-μ΄κΈ°-μ…‹ν…---μΈν”„λΌ.md/4.png)


**`Build`** **μ‹¤ν–‰ κ²°κ³Ό**


![5](/assets/img/2024-03-08-ν”„λ΅μ νΈ--λ‘μ†-ν”„λ΅μ νΈ-μ΄κΈ°-μ…‹ν…---μΈν”„λΌ.md/5.png)


μ£Όλ ν”λ΅μ°

1. _node_modules μΊμ‹ μ„¤μ •_
2. λΉλ“ ν…μ¤νΈ

**`Deploy`** **μ‹¤ν–‰ κ²°κ³Ό**


![6](/assets/img/2024-03-08-ν”„λ΅μ νΈ--λ‘μ†-ν”„λ΅μ νΈ-μ΄κΈ°-μ…‹ν…---μΈν”„λΌ.md/6.png)


μ£Όλ ν”λ΅μ°

1. _node_modules μΊμ‹ μ„¤μ •_
2. λΉλ“ μν–‰
3. λ°±κ·ΈλΌμ΄λ“μ—μ„ λΉλ“λ nodejs μ„λ²„ μ‹¤ν–‰
